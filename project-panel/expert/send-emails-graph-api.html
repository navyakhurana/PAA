<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-project-panel/expert/send-emails-graph-api/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Send e-mails using Microsoft Graph | Build resilient apps with SAP BTP</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://navyakhurana.github.io/PAA/project-panel/expert/send-emails-graph-api"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Send e-mails using Microsoft Graph | Build resilient apps with SAP BTP"><meta data-rh="true" name="description" content="In this tutorial, you will learn how to send e-mails from your SaaS application using the Microsoft Graph API and Exchange Online. This can be useful in scenarios requiring automated messages sent to users from within your application. This is just one approach how to programmatically send e-mails using popular Microsoft services. Alternatively, you might think about configuring a destination to your SMTP server or using similar services offered by other providers like AWS Simple Email Service (SES) or SendGrid."><meta data-rh="true" property="og:description" content="In this tutorial, you will learn how to send e-mails from your SaaS application using the Microsoft Graph API and Exchange Online. This can be useful in scenarios requiring automated messages sent to users from within your application. This is just one approach how to programmatically send e-mails using popular Microsoft services. Alternatively, you might think about configuring a destination to your SMTP server or using similar services offered by other providers like AWS Simple Email Service (SES) or SendGrid."><link data-rh="true" rel="icon" href="/PAA/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://navyakhurana.github.io/PAA/project-panel/expert/send-emails-graph-api"><link data-rh="true" rel="alternate" href="https://navyakhurana.github.io/PAA/project-panel/expert/send-emails-graph-api" hreflang="en"><link data-rh="true" rel="alternate" href="https://navyakhurana.github.io/PAA/project-panel/expert/send-emails-graph-api" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://SX6JA1B3F5-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Build resilient apps with SAP BTP" href="/PAA/opensearch.xml">

<script src="js/custom.js" async></script><link rel="stylesheet" href="/PAA/assets/css/styles.f9497dcc.css">
<link rel="preload" href="/PAA/assets/js/runtime~main.226771eb.js" as="script">
<link rel="preload" href="/PAA/assets/js/main.9fe92f58.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/PAA/"><div class="navbar__logo"><img src="/PAA/img/githubFolder.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/PAA/img/githubFolder.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Develop a multitenant Software as a Service application in SAP BTP using CAP</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/SAP-samples/btp-kyma-cap-multitenant-susaas" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/PAA/">OVERVIEW</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/PAA/category/project-panel">PROJECT PANEL</a><button aria-label="Toggle the collapsible sidebar category &#x27;PROJECT PANEL&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/PAA/category/discover">Discover</a><button aria-label="Toggle the collapsible sidebar category &#x27;Discover&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/PAA/category/basic">Basic</a><button aria-label="Toggle the collapsible sidebar category &#x27;Basic&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/PAA/category/advanced">Advanced</a><button aria-label="Toggle the collapsible sidebar category &#x27;Advanced&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/PAA/category/expert">Expert</a><button aria-label="Toggle the collapsible sidebar category &#x27;Expert&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/introduction-expert-features">Introduction to the Expert Features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/backup-database-containers">Backup SAP HANA Cloud Database Containers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/consumer-extensibility">SaaS Consumer Extensibility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/custom-domain-for-ias">Custom Domain for SAP Identity Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/custom-domain-usage">Custom Domain Usage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/deploy-multiple-regions">Deployment to multiple SAP BTP regions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/feature-toggles">Feature Toggles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/hdi-container-administration">HDI Container Administration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/integrate-consumers-idp">Integration of Consumer IdPs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/local-hybrid-development">Local and hybrid development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/manage-tenant-containers">Manage Tenant Database Containers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/multiple-hana-cloud">Use multiple SAP HANA Cloud instances</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/onboard-automation-domain">Self-Registration, Onboarding Automation and One-Domain Concept</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/PAA/project-panel/expert/send-emails-graph-api">Send e-mails using Microsoft Graph</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/PAA/project-panel/expert/update-tenant-containers">Update Tenant database containers</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/PAA/support">SUPPORT</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/PAA/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/PAA/category/project-panel"><span itemprop="name">PROJECT PANEL</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/PAA/category/expert"><span itemprop="name">Expert</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Send e-mails using Microsoft Graph</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Send e-mails using Microsoft Graph</h1><p>In this tutorial, you will learn how to send e-mails from your SaaS application using the Microsoft Graph API and Exchange Online. This can be useful in scenarios requiring automated messages sent to users from within your application. This is just one approach how to programmatically send e-mails using popular Microsoft services. Alternatively, you might think about configuring a destination to your SMTP server or using similar services offered by other providers like AWS Simple Email Service (SES) or SendGrid. </p><ul><li><a href="#send-e-mails-using-microsoft-graph">Send e-mails using Microsoft Graph</a><ul><li><a href="#1-introduction">1. Introduction</a></li><li><a href="#2-prerequisites">2. Prerequisites</a></li><li><a href="#3-create-a-shared-mailbox">3. Create a Shared Mailbox</a></li><li><a href="#4-create-an-application-registration">4. Create an Application Registration</a></li><li><a href="#5-test-the-sample-application">5. Test the sample application</a></li><li><a href="#6-resource-owner-password-flow">6. Resource Owner Password Flow</a></li><li><a href="#7-further-information">7. Further Information</a></li></ul></li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span><mdxadmonitiontitle><strong>Important</strong> </mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>The below sample approach works with a very powerful Graph API permission on Application-level. In a productive environment, this permission should be immediately restricted after setup, to prevent misuse by application developers. Otherwise, this setup allows anyone in possession of the respective credentials to send e-mails on behalf of any Active Directory user! Please follow the official Microsoft documentation (<a href="https://learn.microsoft.com/en-us/graph/auth-limit-mailbox-access" target="_blank" rel="noopener noreferrer">click here</a>) to set up a corresponding restriction. </p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-introduction">1. Introduction<a href="#1-introduction" class="hash-link" aria-label="Direct link to 1. Introduction" title="Direct link to 1. Introduction">​</a></h2><p>Most SaaS applications will require a way to interact with their users via e-mail or other messaging channels. Therefore, nowadays you as a SaaS Provider have various ways of how to set up such an e-mail service integration in your environment. As Microsoft Office 365 and Exchange Online are among the most popular products on the market we will show you how to use them to send out e-mails right from within your application with just a few lines of code. </p><p>While SAP Business Technology Platform offers the option to define a destination of type <strong>MAIL</strong>, you will probably face authentication issues when trying to connect to modern mail servers using IMAP, POP or SMTP. Let&#x27;s have a look at the example of Microsoft Exchange Online, which is used by many enterprise companies out there.  </p><p>In September 2021 Microsoft published the following statement: &quot;<em>[...]<!-- --> effective October 1, 2022, we will begin disabling Basic authentication for Outlook, EWS, RPS, POP, IMAP, and EAS protocols in Exchange Online. SMTP Auth will also be disabled if it is not being used. <!-- -->[...]<!-- --> we strongly encourage customers to move away from using Basic authentication with SMTP AUTH when possible. Other options for sending authenticated mail include using alternative protocols, such as the Microsoft Graph API.</em>&quot; (<a href="https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/deprecation-of-basic-authentication-exchange-online" target="_blank" rel="noopener noreferrer">See details here</a>)</p><p>As a consequence, IMAP or POP protocol usage with basic authentication will not be possible anymore in Exchange Online. Furthermore, SMTP Auth will be disabled by default and has to be <strong>explicitly enabled</strong> for an organization or specific mailboxes (<a href="https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/authenticated-client-smtp-submission" target="_blank" rel="noopener noreferrer">see here</a>). Last but not least, if Basic Authentication has been disabled by a respective authentication policy even SMTP Auth protocol will not be usable by clients anymore! </p><p>Given all these security-related restrictions, Microsoft recommends switching to alternative protocols like the <strong>Microsoft Graph API</strong> which will be covered by the following Expert Feature tutorial. </p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><mdxadmonitiontitle><strong>Hint</strong> </mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>If you are using a different e-mail service provider, enabled SMTP AUTH and Basic Authentication in your environment, or host your own e-mail server in an On-Premise landscape, considering a destination of type <strong>MAIL</strong> or usage of <strong>SAP Cloud Integration</strong> might still be an option for you (<a href="https://blogs.sap.com/2020/01/08/cloud-integration-connect-cpi-with-your-on-premise-mail-server/" target="_blank" rel="noopener noreferrer">click here</a>). SAP Cloud Integration also offers an OAuth2 based integration with Microsoft Exchange (<a href="https://blogs.sap.com/2020/08/20/cloud-intgration-connect-to-microsoft-365-mail-with-oauth2/" target="_blank" rel="noopener noreferrer">click here</a>).</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-prerequisites">2. Prerequisites<a href="#2-prerequisites" class="hash-link" aria-label="Direct link to 2. Prerequisites" title="Direct link to 2. Prerequisites">​</a></h2><p><strong>Microsoft Azure</strong></p><p>To create an application registration that can be used to send e-mails via Microsoft Graph, you will need an active Microsoft Azure account including an Azure Active Directory.  You can sign up for a free Microsoft Azure account here <a href="https://azure.microsoft.com/en-in/free" target="_blank" rel="noopener noreferrer">https://azure.microsoft.com/en-in/free</a>.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><mdxadmonitiontitle><strong>Hint</strong> </mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>For testing purposes, you can go with a free Azure account and you don&#x27;t need a paid Azure subscription.</p></div></div><p><strong>Exchange Online</strong></p><p>You can send e-mails by either using a shared mailbox or a regular user&#x27;s inbox. For both scenarios, you need to have at least one valid license including Exchange Online access (like Office 365 F3). After creating a Microsoft Azure account, log in to the Microsoft 365 Admin Center here <a href="https://admin.microsoft.com/#/homepage" target="_blank" rel="noopener noreferrer">https://admin.microsoft.com/#/homepage</a>. This is where you can buy and see your licensed products like an Office 365 F3 subscription. </p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><mdxadmonitiontitle><strong>Hint</strong> </mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>For testing purposes, check if you&#x27;re eligible for a free <a href="https://learn.microsoft.com/en-us/microsoftteams/teams-exploratory" target="_blank" rel="noopener noreferrer">Microsoft Teams Exploratory</a> license. This license also contains the required Exchange Online access. </p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-create-a-shared-mailbox">3. Create a Shared Mailbox<a href="#3-create-a-shared-mailbox" class="hash-link" aria-label="Direct link to 3. Create a Shared Mailbox" title="Direct link to 3. Create a Shared Mailbox">​</a></h2><p>Having a valid license (including the Exchange Online feature) assigned to your Microsoft 365 account, you can switch to the <a href="https://admin.exchange.microsoft.com/#/mailboxes" target="_blank" rel="noopener noreferrer">Exchange Admin Center</a> to create a new shared mailbox. You can find more information and limitations of Shared Mailboxes in the official Microsoft documentation (<a href="https://learn.microsoft.com/en-us/microsoft-365/admin/email/about-shared-mailboxes" target="_blank" rel="noopener noreferrer">click here</a>).</p><p>In the below sample, we created two shared mailboxes. One is for automated messages sent by the application, which is not supposed to receive any response messages (<strong><a href="mailto:donotreply@susaas.com" target="_blank" rel="noopener noreferrer">donotreply@susaas.com</a></strong>). The other shared mailbox is the contact e-mail address of our SaaS application (<strong><a href="mailto:info@susaas.com" target="_blank" rel="noopener noreferrer">info@susaas.com</a></strong>) accessible by one or multiple delegate users. This contact mailbox can also receive messages. </p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Mail_SharedMailbox.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Mail_SharedMailbox-d7e4f1c0b76a199d8ec458899f041381.png" width="1484" height="563" class="img_ev3q"></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><mdxadmonitiontitle><strong>Hint</strong> </mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>In this case, susaas.com was registered as a custom Domain in the respective Admin Center settings. For test scenarios, you can also go with the default *.onmicrosoft.com domain assigned to your account. </p></div></div><p>The Exchange Admin Center provides a lot of options that we cannot cover in this tutorial like the rule used in our DoNotReply mailbox which automatically deletes all messages arriving in the mailbox. Feel free to explore further options of Exchange Online.</p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Mail_DoNotReply.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Mail_DoNotReply-47e78a06abd3a4dbad6c04b4995bf918.png" width="1474" height="690" class="img_ev3q"></p><p>While the DoNotReply mailbox does not need any delegate access permissions as it is only used to send e-mails from within the SaaS application, the regular contact mailbox requires delegate access. You can add multiple users responsible for maintaining the contact mailbox. </p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Mail_DelegateAccess.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Mail_DelegateAccess-a136ef1c228fb233b33baa1618c8f7ab.png" width="1236" height="653" class="img_ev3q"></p><p>Each delegate user needs to have a valid license assigned that contains Exchange Online access (like Office 365 F3). If the user does not appear in the list of available users in the Exchange Admin Center, please switch back to the <a href="https://admin.microsoft.com/#/homepage" target="_blank" rel="noopener noreferrer">Microsoft 365 Admin Center</a>, select the user, and switch to the <strong>Mail</strong> tab. This should initialize the Exchange Online usage within a few minutes. </p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Mail_ActivateMail.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Mail_ActivateMail-5e8d9c666ae5d03c6a83fb4789e7bda4.png" width="1377" height="693" class="img_ev3q"></p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span><mdxadmonitiontitle><strong>Important</strong> </mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>Each shared mailbox results in a new user in your Microsoft 365 Admin Center. This user is not supposed to be used for logins and the password must not be changed! Furthermore, you don&#x27;t need to assign any licenses to the shared mailbox users. </p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-create-an-application-registration">4. Create an Application Registration<a href="#4-create-an-application-registration" class="hash-link" aria-label="Direct link to 4. Create an Application Registration" title="Direct link to 4. Create an Application Registration">​</a></h2><p>You can use a standard Azure Active Directory <strong>Application Registration</strong> to send e-mails using the Microsoft Graph API. An application registration allows you to retrieve access tokens from Azure Active Directory for a certain scope (e.g., Microsoft Graph usage). The authorized scopes/permissions can be defined for each Application Registration. The process to create such an Application Registration is very simple. </p><p>4.1. Go to the <a href="https://portal.azure.com/#home" target="_blank" rel="noopener noreferrer">Azure Portal</a> and access your Azure Active Directory instance.</p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppReg01.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppReg01-22669bea3f63589e33d457b690ddac69.png" width="962" height="449" class="img_ev3q"></p><p>4.2. Switch to <strong>App registrations</strong> and click on <strong>New registration</strong>. </p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppReg02.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppReg02-4bbac1d2efc94b50d42f9c257db82172.png" width="984" height="696" class="img_ev3q"></p><p>4.3. Define a name of your choice, select the Single Tenant mode and click on <strong>Register</strong>.</p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppReg03.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppReg03-f37917be1cbc399750551144d0ac49d3.png" width="1194" height="956" class="img_ev3q"></p><p>4.4. Your Application Registration is created and you are redirected to the Overview page. </p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span><mdxadmonitiontitle><strong>Hint</strong> </mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>Note the <strong>Application (client) ID</strong> and the <strong>Directory (tenant) ID</strong>. You will need these values for authentication in your sample application.</p></div></div><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppReg04.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppReg04-de8cafc2793fdf9310c0595b53311b3c.png" width="1083" height="579" class="img_ev3q"></p><p>4.5. Switch to <strong>API permissions</strong> and click on <strong>Add a permission</strong>.</p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppReg05.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppReg05-fe91879a1af8203bf3ad66952cd02876.png" width="1036" height="665" class="img_ev3q"></p><p>4.6. Select <strong>Microsoft Graph</strong> from the available APIs, click on <strong>Application permissions</strong> and search for the <strong>Mail.Send</strong> permission. Select it and click on <strong>Add permissions</strong>. </p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppReg06.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppReg06-73ce80148173608f23afa90ef9f62690.png" width="1655" height="867" class="img_ev3q"></p><p>4.7. This is a very powerful permission, as it is set on Application-level and allows you to send e-mails on behalf of any user in your directory. For that reason, <strong>admin consent</strong> has to be given for this permission. </p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span><mdxadmonitiontitle><strong>Important</strong> </mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>Please check the official <a href="https://docs.microsoft.com/en-us/graph/auth-limit-mailbox-access" target="_blank" rel="noopener noreferrer">Microsoft documentation</a> to learn more about how to restrict the application&#x27;s access permissions to certain mailboxes! </p></div></div><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppReg07.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppReg07-4aa10b0a2e12821dd29f25e53654a540.png" width="1655" height="819" class="img_ev3q"></p><p>4.8. You can remove the <strong>User.Read</strong> permission and admin consent from the API permissions list as you can see in the below screenshots. </p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppReg08.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppReg08-c7baf89f382e867892c308a00f2d475d.png" width="1656" height="838" class="img_ev3q"></p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppReg09.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppReg09-d4c16a69b2b834bbf5c15d3553159c9f.png" width="1653" height="857" class="img_ev3q"></p><p>4.9. Switch to the <strong>Certificates &amp; secrets</strong> section and create a new <strong>Client Secret</strong>. Please copy the Secret value as you won&#x27;t be able to see it again once you leave the page. </p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppReg10.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppReg10-a5a6177ff7d7777a17e6d95c4a139abb.png" width="1654" height="866" class="img_ev3q"></p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppReg11.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppReg11-a42f8aa7f33bdc03a9a33c38891892e2.png" width="1400" height="827" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-test-the-sample-application">5. Test the sample application<a href="#5-test-the-sample-application" class="hash-link" aria-label="Direct link to 5. Test the sample application" title="Direct link to 5. Test the sample application">​</a></h2><p>5.1. Go to the <a href="/PAA/project-panel/send-emails-graph-api/code">code directory</a> of this Expert Feature topic where you can find the sample application for testing your setup. Copy the index.js and package.json files to place on your local device - just to ensure you&#x27;re not pushing any of your secrets to GitHub. </p><p>5.2. Open a terminal window and switch to the directory in which you copied the provided files. Install the required dependencies by running the <strong>npm install</strong> command in the respective directory. </p><p>5.3. Open the index.js file and update the following code sections. </p><p>5.3.1. Update the credentials based on the Secret you created in the previous steps and the application details you can find in the Overview page of the application registration.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> credential </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ClientSecretCredential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;&lt;&lt;a22bd-...-a1f071e&gt;&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Directory (tenant) ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;&lt;&lt;9b79b-...-1f1c55d&gt;&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Application (client) ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;&lt;&lt;ZYM8Q~...~SUscdn2&gt;&gt;&#x27;</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// Application Secret</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>5.3.2. Insert a valid e-mail address for the recipient of your test message. </p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> sendMail </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">message</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">subject</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Meet for lunch?&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">body</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">contentType</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Text&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">content</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;The new cafeteria is open!&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">toRecipients</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">emailAddress</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token literal-property property" style="color:#36acaa">address</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;&lt;mail.address@of.recipient&gt;&gt;&#x27;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Recipient&#x27;s e-mail address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">saveToSentItems</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;false&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>5.3.3. Insert the e-mail address of your shared mailbox which you created at the beginning of this tutorial.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">api</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/users/&lt;&lt;mail.address@of.mailbox&gt;&gt;/sendMail&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// Shared mailbox e-mail address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">header</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Content-type&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;application/json&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sendMail</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">err</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> res</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> rawResponse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rawResponse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>5.4. Save the index.js file and run <strong>npm run start</strong> in your terminal. If you see a result like below, your e-mail was sent successfully. </p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_SendMail.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_SendMail-ab80eaa3d815c439638a8ee49013dcc9.png" width="857" height="356" class="img_ev3q"></p><p>5.5. Check the inbox of your recipient&#x27;s e-mail address where the message should have arrived. </p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_SendMail01.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_SendMail01-e63dbbd3db7832829d64f5c39c365919.png" width="1411" height="473" class="img_ev3q"></p><p>5.7. You can now integrate the above coding into your application by using e.g., a new helper class in your Business Application Service. </p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span><mdxadmonitiontitle><strong>Important</strong> </mdxadmonitiontitle></div><div class="admonitionContent_S0QG"><p>Make sure to store your credential values securely in your SAP Credential Store and rotate the values on a regular basis! Furthermore, you might think about improving your security setup by using an X.509 certificate to obtain the access token instead of Client Credentials. </p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-resource-owner-password-flow">6. Resource Owner Password Flow<a href="#6-resource-owner-password-flow" class="hash-link" aria-label="Direct link to 6. Resource Owner Password Flow" title="Direct link to 6. Resource Owner Password Flow">​</a></h2><p>Although Microsoft does not recommend the usage of the following alternative approach (<a href="https://learn.microsoft.com/en-us/azure/active-directory/develop/v2-oauth-ropc" target="_blank" rel="noopener noreferrer">see here</a>), we still want to quickly mention it here. Instead of using the Client Credentials Flow in combination with permissions on Application-level, you can also make use of the Resource Owner Password Flow, combined with Delegate permissions. </p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppPwFlow01.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppPwFlow01-f72f438ca759a35327d40259f1ee3ce5.png" width="1275" height="735" class="img_ev3q"></p><p><img loading="lazy" alt="&amp;lt;img src=&amp;quot;./images/Azure_AppPwFlow02.png&amp;quot; width=&amp;quot;500&amp;quot; /&amp;gt;" src="/PAA/assets/images/Azure_AppPwFlow02-24e5c818f414c7540dddc4340869a750.png" width="1061" height="712" class="img_ev3q"></p><p>This approach comes with the drawback, that the Application Registration has to be configured for Public Client access, and you need to store the password of a dedicated Directory user in your SAP Credential Store. As said, this approach is not recommended by Microsoft and should only be used if the Client Credentials Flow (combined with a mailbox restriction) cannot be used for any reason. </p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">UsernamePasswordCredential</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;@azure/identity&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> credential </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">UsernamePasswordCredential</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;&lt;&lt;a22bd-...-a1f071e&gt;&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Directory (tenant) ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;&lt;&lt;9b79b-...-1f1c55d&gt;&gt;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// Application (client) ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;&lt;&lt;sample.user@azure.directory&gt;&gt;&#x27;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// Username</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;&lt;&lt;password-of-sample-user&gt;&gt;&#x27;</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// Password</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this case, if you want to use the shared mailbox as sender of the message, you need to add the user as a delegate to this mailbox. Otherwise, you can only send messages on behalf of this user as shown below. </p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">api</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;/users/&lt;&lt;mail.address@sample.user&gt;&gt;/sendMail&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// User e-mail address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">header</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Content-type&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;application/json&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sendMail</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">err</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> res</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> rawResponse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rawResponse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-further-information">7. Further Information<a href="#7-further-information" class="hash-link" aria-label="Direct link to 7. Further Information" title="Direct link to 7. Further Information">​</a></h2><p>Please use the following links to find further information on the topics above:</p><ul><li><a href="https://blogs.sap.com/2020/08/20/cloud-intgration-connect-to-microsoft-365-mail-with-oauth2/" target="_blank" rel="noopener noreferrer">SAP Blog - Cloud Integration – Connect to Microsoft 365 Mail with OAuth2</a></li><li><a href="https://blogs.sap.com/2020/01/08/cloud-integration-connect-cpi-with-your-on-premise-mail-server/" target="_blank" rel="noopener noreferrer">SAP Blog - Cloud Integration – Connect CPI with Your On-Premise Mail Server</a></li><li><a href="https://blogs.sap.com/2019/11/28/send-an-email-from-a-nodejs-application/" target="_blank" rel="noopener noreferrer">SAP Blog - Send an email from a nodejs application</a></li><li><a href="https://azure.microsoft.com/en-us/free/" target="_blank" rel="noopener noreferrer">Microsoft - Azure Free Trial</a></li><li><a href="https://www.microsoft.com/en-us/microsoft-365/exchange/exchange-online" target="_blank" rel="noopener noreferrer">Microsoft - Exchange Online</a></li><li><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/email/about-shared-mailboxes?view=o365-worldwide" target="_blank" rel="noopener noreferrer">Microsoft - About shared mailboxes</a></li><li><a href="https://learn.microsoft.com/en-us/azure/active-directory/develop/application-model" target="_blank" rel="noopener noreferrer">Microsoft - Application model</a></li><li><a href="https://learn.microsoft.com/en-us/graph/overview" target="_blank" rel="noopener noreferrer">Microsoft - Graph API</a></li><li><a href="https://learn.microsoft.com/en-us/graph/api/user-sendmail" target="_blank" rel="noopener noreferrer">Microsoft - Graph API - sendMail</a></li><li><a href="https://learn.microsoft.com/en-us/azure/active-directory/develop/permissions-consent-overview" target="_blank" rel="noopener noreferrer">Microsoft - Introduction to permissions and consent</a></li><li><a href="https://learn.microsoft.com/en-us/azure/active-directory/develop/v2-permissions-and-consent#admin-restricted-permissions" target="_blank" rel="noopener noreferrer">Microsoft - Admin-restricted permissions</a></li><li><a href="https://learn.microsoft.com/en-us/graph/auth-limit-mailbox-access" target="_blank" rel="noopener noreferrer">Microsoft - Limiting application permissions to specific Exchange Online mailboxes</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-08-29T06:17:59.000Z">Aug 29, 2023</time></b> by <b>Navya khurana</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/PAA/project-panel/expert/onboard-automation-domain"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Self-Registration, Onboarding Automation and One-Domain Concept</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/PAA/project-panel/expert/update-tenant-containers"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Update Tenant database containers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-introduction" class="table-of-contents__link toc-highlight">1. Introduction</a></li><li><a href="#2-prerequisites" class="table-of-contents__link toc-highlight">2. Prerequisites</a></li><li><a href="#3-create-a-shared-mailbox" class="table-of-contents__link toc-highlight">3. Create a Shared Mailbox</a></li><li><a href="#4-create-an-application-registration" class="table-of-contents__link toc-highlight">4. Create an Application Registration</a></li><li><a href="#5-test-the-sample-application" class="table-of-contents__link toc-highlight">5. Test the sample application</a></li><li><a href="#6-resource-owner-password-flow" class="table-of-contents__link toc-highlight">6. Resource Owner Password Flow</a></li><li><a href="#7-further-information" class="table-of-contents__link toc-highlight">7. Further Information</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/PAA/">Overview</a></li></ul></div><div class="col footer__col"><div class="footer__title">SAP Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blogs.sap.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blogs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://answers.sap.com/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Q&amp;A<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discovery-center.cloud.sap/index.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discovery Center<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/SAP-samples/btp-kyma-cap-multitenant-susaas" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Repo<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/PAA/assets/js/runtime~main.226771eb.js"></script>
<script src="/PAA/assets/js/main.9fe92f58.js"></script>
</body>
</html>